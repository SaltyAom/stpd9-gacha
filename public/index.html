<!doctype html>
<html lang="en">
    <head>
        <title>Stupid Hackathon 9 Gacha</title>

        <link
            rel="icon"
            href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üßÇ</text></svg>"
        />

        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link
            rel="preconnect"
            href="https://fonts.gstatic.com"
            crossorigin="true"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap"
            rel="stylesheet"
        />

        <link rel="preload" href="/himari-gaming.mp4" as="video" />
        <link rel="preload" href="/salt-1.webp" as="image" />
        <link rel="preload" href="/salt-2.webp" as="image" />
        <link rel="preload" href="/salt-3.webp" as="image" />
        <link rel="preload" href="/koyuki.webp" as="image" />
        <link rel="preload" href="/p-chan.webp" as="image" />

        <meta
            name="og:image"
            content="https://stpd9-gacha.gehenna.sh/cover.webp"
        />
        <meta name="og:image:width" content="2942" />
        <meta name="og:image:height" content="1798" />
        <meta name="og:title" content="Stupid Hackathon 9 Gacha" />
        <meta name="og:description" content="‡∏ï‡∏π‡πâ‡∏Å‡∏≤‡∏ä‡∏≤ Stupid Hackathon 9" />
        <meta name="og:type" content="website" />
        <meta name="og:url" content="https://stpd9-gacha.gehenna.sh/" />
        <meta name="og:site_name" content="Stupid Hackathon 9 Gacha" />
        <meta name="twitter:card" content="summary_large_image" />
        <meta
            name="twitter:image"
            content="https://stpd9-gacha.gehenna.sh/cover.webp"
        />
        <meta name="twitter:title" content="Stupid Hackathon 9 Gacha" />
        <meta name="twitter:description" content="‡∏ï‡∏π‡πâ‡∏Å‡∏≤‡∏ä‡∏≤ Stupid Hackathon 9" />

        <script
            src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstileCallback"
            defer
        ></script>

        <style>
            :root {
                --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
            }

            body {
                font-family: 'Kanit', sans-serif !important;
            }

            .fade-in {
                animation: fadeIn 0.5s var(--ease-out-expo);
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                }
                to {
                    opacity: 1;
                }
            }

            .slide-up {
                animation: slideUp 0.5s var(--ease-out-expo);
            }

            @keyframes slideUp {
                from {
                    opacity: 0;
                    transform: translateY(25vh);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            .gacha-in {
                will-change: opacity, transform;
                animation: gachaIn 0.5s var(--ease-out-expo);
                animation-fill-mode: backwards;
            }

            @keyframes gachaIn {
                from {
                    opacity: 0;
                    transform: scale(0.9);
                }

                to {
                    opacity: 1;
                    transform: scale(1);
                }
            }

            dialog:not([open]) {
                display: none;
            }

            @media (max-width: 48rem) {
                .critical-size {
                    zoom: 0.75;
                }
            }
        </style>
    </head>
    <body
        class="flex justify-center items-start min-h-screen overflow-hidden px-2"
    >
        <video
            class="absolute top-0 left-0 w-full h-full object-cover object-center scale-135"
            autoplay
            loop
            muted
            nocontrols
            playsinline
        >
            <source src="/himari-gaming.mp4" type="video/mp4" />
        </video>

        <audio id="bgm" class="hidden" loop>
            <source src="/ost-11.mp3" type="audio/mp3" />
        </audio>

        <article
            class="z-10 flex flex-col max-w-3xl w-full bg-sky-50 my-auto ml-auto lg:mr-12 border border-sky-900/30 shadow-md shadow-black/20 rounded-sm"
        >
            <div class="flex flex-col p-4">
                <small
                    class="text-base font-light text-sky-900 px-2 py-1 mb-4 bg-sky-500/10"
                >
                    2025/07/13 ~ ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡∏±‡πã‡∏ß‡∏´‡∏°‡∏î
                </small>

                <h1 class="text-3xl text-sky-900">‡∏ï‡∏π‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏ó‡∏û‡∏¥‡πÄ‡∏®‡∏© 1</h1>
                <hr class="h-1 my-1 bg-gray-300 border-0" />
                <h2 class="text-sky-500 md:text-lg">
                    „Äå‡∏û‡∏¥‡πÄ‡∏®‡∏©„Äç ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πã‡∏ß Stupid Hackathon ‡∏î‡πâ‡∏ß‡∏¢!
                </h2>
                <hr class="h-1 my-1 bg-gray-300 border-0" />
                <h3 class="text-gray-600 md:text-lg font-light">
                    ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î 10 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ 1 ‡∏≠‡∏±‡∏ô!
                </h3>
                <h3 class="text-gray-600 md:text-lg pl-2 font-light">
                    ‚à¥ ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ ‡∏ï‡∏±‡πã‡∏ß Stupid Hackathon ‡πÅ‡∏•‡πâ‡∏ß
                    ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏•‡∏Å‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö EventPop ‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏∏‡πà‡∏°
                    "‡πÅ‡∏•‡∏Å‡∏ï‡∏±‡πã‡∏ß"
                </h3>

                <p
                    id="verifying"
                    class="hidden text-gray-600 text-lg pl-2 font-light mt-4"
                >
                    ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...
                </p>

                <section
                    class="flex flex-col sm:flex-row gap-4 sm:gap-6 mt-4 sm:mt-12 px-4 critical-size"
                >
                    <button
                        onclick="pull1()"
                        disabled
                        class="pull flex flex-1 justify-center items-center bg-sky-400/70 -skew-x-12 text-white font-semibold py-2 rounded-xl shadow-md shadow-black/20 border border-sky-900/30 disabled:active:scale-100 active:scale-95 transition-transform duration-200 ease-out disabled:opacity-75 disabled:cursor-wait"
                    >
                        <div class="flex gap-6 font-normal skew-x-12">
                            <img
                                src="/1roll.webp"
                                class="size-16 sm:size-20 my-auto"
                            />
                            <div
                                class="flex flex-col justify-center gap-1 sm:gap-2 min-w-40"
                            >
                                <div
                                    class="text-lg sm:text-xl text-white bg-sky-900 p-0.5 -skew-x-12 rounded"
                                >
                                    <img
                                        class="absolute skew-x-12 -left-3 -top-0.5 h-9"
                                        src="pyrox.webp"
                                        alt="Pyroxene"
                                    />
                                    <s class="opacity-75 text-base">120</s>
                                    <span class="ml-2 mr-8">0</span>
                                </div>
                                <p
                                    class="text-3xl text-sky-900 text-right pr-2"
                                >
                                    ‡πÄ‡∏õ‡∏¥‡∏î 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                                </p>
                            </div>
                        </div>
                    </button>

                    <button
                        onclick="pull10()"
                        disabled
                        class="pull flex flex-1 justify-center items-center bg-yellow-400/70 -skew-x-12 text-white font-semibold py-2 rounded-xl shadow-md shadow-black/20 border border-yellow-900/30 disabled:active:scale-100 active:scale-95 transition-transform duration-200 ease-out disabled:opacity-75 disabled:cursor-wait"
                    >
                        <div class="flex gap-6 font-normal skew-x-12">
                            <img
                                src="/10roll.webp"
                                class="size-16 sm:size-20 my-auto"
                            />
                            <div
                                class="flex flex-col justify-center gap-1 sm:gap-2 min-w-40"
                            >
                                <div
                                    class="text-lg sm:text-xl text-white bg-yellow-900 p-0.5 -skew-x-12 rounded"
                                >
                                    <img
                                        class="absolute skew-x-12 -left-3 -top-0.5 h-9"
                                        src="pyrox.webp"
                                        alt="Pyroxene"
                                    />
                                    <s class="opacity-75 text-base">1,200</s>
                                    <span class="ml-2 mr-8">0</span>
                                </div>
                                <p
                                    class="text-3xl text-yellow-900 text-right pr-2"
                                >
                                    ‡πÄ‡∏õ‡∏¥‡∏î 10 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                                </p>
                            </div>
                        </div>
                    </button>
                </section>
            </div>

            <footer
                class="flex flex-row gap-4 sm:gap-6 text-2xl px-4 sm:px-6 py-2 bg-sky-300/50 critical-size"
            >
                <div class="flex flex-1 py-1 pl-8 sm:pl-12">
                    <div
                        class="flex justify-center items-center w-full -skew-x-12 border-2 border-sky-900/70 rounded"
                    >
                        <img
                            src="/point.webp"
                            alt="Point"
                            class="absolute -top-2 -left-10 h-14 sm:h-18"
                        />
                        <p class="flex flex-2 justify-center p-2.5 bg-white">
                            <span class="text-sky-800 skew-x-12">
                                ‡πÅ‡∏ï‡πâ‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö
                            </span>
                        </p>
                        <p
                            class="flex flex-1 justify-center p-2.5 bg-sky-900/90"
                        >
                            <span class="text-white skew-x-12" id="total-pull">
                            </span>
                        </p>
                    </div>
                </div>
                <a
                    href="https://www.eventpop.me/e/96772/sht9"
                    class="flex justify-center items-center px-6 sm:px-12 py-3 -skew-x-12 bg-sky-50/70 text-center text-sky-900 rounded-xl shadow-md shadow-black/20 border border-sky-900/30 active:scale-95 transition-transform duration-200 ease-out"
                >
                    ‡πÅ‡∏•‡∏Å‡∏ï‡∏±‡πã‡∏ß
                </a>
            </footer>
        </article>

        <footer
            class="fixed left-0 bottom-0 flex gap-3 py-6 px-8 critical-size"
        >
            <button
                onclick="document.getElementById('rate').setAttribute('open', '')"
                class="px-6 py-3 -skew-x-12 text-lg bg-gray-50 text-gray-600 rounded-xl shadow-md shadow-black/20 border border-sky-900/30 active:scale-95 transition-transform duration-200 ease-out"
            >
                <p class="skew-x-12">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö</p>
            </button>
            <button
                onclick="loadHistory()"
                class="px-6 py-3 -skew-x-12 text-lg bg-sky-950 text-white rounded-xl shadow-md shadow-black/20 border border-sky-900/30 active:scale-95 transition-transform duration-200 ease-out"
            >
                <p class="skew-x-12">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î</p>
            </button>
        </footer>

        <dialog
            id="rate"
            class="fixed z-30 top-0 left-0 flex justify-center items-center w-full h-full isolate bg-transparent px-4 overflow-hidden"
        >
            <div
                class="absolute bg-black/50 w-full h-screen fade-in"
                onclick="document.getElementById('rate').close()"
            ></div>
            <article
                class="z-10 flex flex-col max-w-5xl w-full rounded-2xl bg-white border border-sky-900/30 shadow-md shadow-black/20 slide-up"
            >
                <header
                    class="flex bg-sky-50/95 rounded-t-2xl text-sky-900 pl-16"
                >
                    <h1
                        class="text-3xl p-3 border-b-6 border-yellow-300 mx-auto"
                    >
                        ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö
                    </h1>
                    <button
                        class="flex justify-center items-center size-16 text-4xl"
                        onclick="document.getElementById('rate').close()"
                    >
                        ‚úï
                    </button>
                </header>
                <section class="p-4 max-h-[80vh] overflow-y-auto">
                    <table class="text-lg">
                        <thead>
                            <tr
                                class="*:px-4 *:py-2 border-b border-sky-700/20"
                            >
                                <td class="w-full">‡∏ä‡∏∑‡πà‡∏≠</td>
                                <td class="min-w-36">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</td>
                                <td class="min-w-42">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö</td>
                            </tr>
                        </thead>
                        <tbody class="text-gray-500 font-light">
                            <tr class="*:px-4 *:py-2">
                                <td class="w-full">
                                    ‡∏£‡∏´‡∏±‡∏™‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πã‡∏ß Stupid Hackathon (Limited)
                                </td>
                                <td class="min-w-36">3 ‡πÉ‡∏ö (‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ)</td>
                                <td class="min-w-42">0.01%</td>
                            </tr>
                            <tr class="*:px-4 *:py-2">
                                <td class="w-full">‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡∏ï‡∏£‡∏≤ P-chan</td>
                                <td class="min-w-36">‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î</td>
                                <td class="min-w-42">0.5%</td>
                            </tr>
                            <tr class="*:px-4 *:py-2">
                                <td class="w-full">‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡∏ï‡∏£‡∏≤ Koyuki</td>
                                <td class="min-w-36">‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î</td>
                                <td class="min-w-42">2%</td>
                            </tr>
                            <tr class="*:px-4 *:py-2">
                                <td class="w-full">‡πÄ‡∏Å‡∏•‡∏∑‡∏≠</td>
                                <td class="min-w-36">‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î</td>
                                <td class="min-w-42">97.49%</td>
                            </tr>
                        </tbody>
                    </table>

                    <p
                        class="text-sky-900 font-light px-2 mt-4 border-t border-sky-700/20 pt-4"
                    >
                        ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ ‡∏ï‡∏±‡πã‡∏ß Stupid Hackathon ‡πÅ‡∏•‡πâ‡∏ß
                        ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏•‡∏Å‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö EventPop
                        ‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏∏‡πà‡∏° "‡πÅ‡∏•‡∏Å‡∏ï‡∏±‡πã‡∏ß"
                        <br />
                        <br />
                        ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ ‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡∏Å‡∏ï‡∏±‡πã‡∏ß Stupid Hackathon
                        ‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏π‡πâ‡∏Å‡∏≤‡∏ä‡∏≤ ‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤
                        ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏¢‡∏±‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡πâ‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                        ‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏•‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏ï‡∏≤‡∏°
                    </p>
                </section>
            </article>
        </dialog>

        <dialog
            id="history"
            class="fixed z-30 top-0 left-0 flex justify-center items-center w-full h-full isolate bg-transparent px-4 overflow-hidden"
        >
            <div
                class="absolute bg-black/50 w-full h-screen fade-in"
                onclick="document.getElementById('history').close()"
            ></div>
            <article
                class="z-10 flex flex-col max-w-5xl w-full rounded-2xl bg-white border border-sky-900/30 shadow-md shadow-black/20 slide-up"
            >
                <header
                    class="flex bg-sky-50/95 rounded-t-2xl text-sky-900 pl-16"
                >
                    <h1
                        class="text-3xl p-3 border-b-6 border-yellow-300 mx-auto"
                    >
                        ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î
                    </h1>
                    <button
                        class="flex justify-center items-center size-16 text-4xl"
                        onclick="document.getElementById('history').close()"
                    >
                        ‚úï
                    </button>
                </header>
                <section class="px-4 max-h-[80vh] overflow-y-auto min-h-36">
                    <p class="text-sky-900 my-4 font-light">
                        ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏Ñ‡πà 500 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
                        <br />
                        ‡∏´‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏¢‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πã‡∏ß Stupid Hackathon
                        ‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢
                    </p>

                    <table class="text-lg">
                        <thead
                            class="sticky top-0 py-4 bg-white border-b border-sky-700/20"
                        >
                            <tr class="*:px-4 *:py-2">
                                <td class="min-w-24">‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà</td>
                                <td class="w-full">‡∏ä‡∏∑‡πà‡∏≠</td>
                            </tr>
                        </thead>
                        <tbody class="text-gray-500 font-light">
                            <tr class="*:px-4 *:py-2">
                                <td class="min-w-24">1</td>
                                <td class="w-full">
                                    ‡∏£‡∏´‡∏±‡∏™‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πã‡∏ß Stupid Hackathon (Limited)
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </section>
            </article>
        </dialog>

        <dialog
            id="gacha"
            class="fixed z-30 top-0 left-0 flex flex-col justify-center items-center w-full h-full isolate bg-sky-50/90 backdrop-blur-xl px-4 overflow-hidden fade-in"
        >
            <main
                id="gacha-result"
                class="grid gap-8 max-w-7xl w-full mx-auto pb-20 lg:pb-0 text-xl lg:text-2xl text-sky-900 text-center"
            ></main>

            <footer
                class="z-10 absolute bottom-26 lg:bottom-16 flex gap-3 sm:gap-6 text-xl sm:text-2xl"
            >
                <button
                    onclick="document.getElementById('gacha').close()"
                    class="px-8 sm:px-12 py-3 sm:py-4 -skew-x-12 bg-sky-300/90 text-sky-900 rounded-xl shadow-md shadow-black/20 border border-sky-900/30 active:scale-95 transition-transform duration-200 ease-out"
                >
                    <p class="skew-x-12">‡∏ï‡∏Å‡∏•‡∏á</p>
                </button>
                <button
                    id="retry"
                    class="pull px-8 sm:px-12 py-3 sm:py-4 -skew-x-12 bg-yellow-300/90 text-yellow-900 rounded-xl shadow-md shadow-black/20 border border-sky-900/30 active:scale-95 transition-transform duration-200 ease-out disabled:active:scale-100 active:scale-95 disabled:opacity-75 disabled:cursor-wait"
                >
                    <p class="skew-x-12">‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                </button>
            </footer>

            <div
                class="absolute bottom-6 lg:bottom-8 right-6 lg:right-8 flex flex-col justify-center items-center max-w-48 w-full -skew-x-12 text-xl border-2 border-sky-900/70 rounded critical-size"
            >
                <img
                    src="/point.webp"
                    alt="Point"
                    class="absolute top-0 -left-14 h-17"
                />
                <p class="flex w-full justify-center p-1 bg-white">
                    <span class="text-sky-800 skew-x-12"> ‡πÅ‡∏ï‡πâ‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö </span>
                </p>
                <p class="flex w-full justify-center p-1 bg-sky-900/90">
                    <span class="text-white skew-x-12" id="total-pull-in-gacha">
                    </span>
                </p>
            </div>
        </dialog>

        <template id="salt">
            <div class="flex flex-col items-center gap-2 gacha-in">
                <img class="w-36" />
                ‡πÄ‡∏Å‡∏•‡∏∑‡∏≠
            </div>
        </template>

        <template id="ticket">
            <a
                class="flex flex-col items-center gap-2 hover:scale-105 active:scale-95 transition-transform duration-200 gacha-in"
            >
                <img class="w-36" src="/ticket.webp" />
                ‡∏ï‡∏±‡πã‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô:
            </a>
        </template>

        <div
            class="cf-turnstile"
            data-sitekey="0x4AAAAAABk3opwgLerMctJc"
            data-callback="turnstileCallback"
        ></div>

        <script>
            const gacha = document.getElementById('gacha')
            const salt = document.getElementById('salt')
            const ticket = document.getElementById('ticket')
            const result = document.getElementById('gacha-result')
            const retry = document.getElementById('retry')
            const totalPull = document.getElementById('total-pull')
            const totalPullInGacha = document.getElementById(
                'total-pull-in-gacha'
            )
            const pulls = document.querySelectorAll('.pull')

            let throttle
            let pending = false
            let token
            let uid = localStorage.getItem('gacha-uid')
            if (!uid)
                localStorage.setItem(
                    'gacha-uid',
                    (id = Math.random().toString(36).substring(2, 10))
                )

            let history = localStorage.getItem('gacha-history')
            history = history ? JSON.parse(history) : []

            const formatNumber = new Intl.NumberFormat('es-US').format
            totalPull.textContent = formatNumber(history.length)
            totalPullInGacha.textContent = formatNumber(history.length)

            document.documentElement.addEventListener(
                'click',
                () => {
                    document.getElementById('bgm')?.play()
                },
                {
                    once: true
                }
            )

            function debounce(ms) {
                if (throttle) return throttle

                throttle = new Promise((resolve) => {
                    setTimeout(() => {
                        throttle = null
                        resolve()
                    }, ms)
                })
            }

            function createTicket(code, delay) {
                const element = ticket.content.cloneNode(true)
                element.firstElementChild.appendChild(
                    document.createTextNode(code)
                )

                if (delay)
                    element.firstElementChild.style.animationDelay =
                        delay + 'ms'

                return element
            }

            function createSalt(delay) {
                const element = salt.content.cloneNode(true)
                const image = element.firstElementChild.firstElementChild

                if (delay)
                    element.firstElementChild.style.animationDelay =
                        delay + 'ms'

                const probability = Math.random()

                if (probability < 0.005)
                    image.setAttribute('src', `/p-chan.webp`)
                else if (probability < 0.02) {
                    image.setAttribute('src', `/koyuki.webp`)
                    setTimeout(() => {
                        nihaha()
                    }, delay)
                } else
                    image.setAttribute(
                        'src',
                        `/salt-${~~(Math.random() * 3) + 1}.webp`
                    )

                return element
            }

            function requestNewToken() {
                turnstile.reset()
                pulls.forEach((pull) => {
                    pull.disabled = true
                })
            }

            async function pull1() {
                if (debounce(200) || pending) return

                requestNewToken()

                pending = true
                const response = await fetch(`/pull/1?uid=${uid}`, {
                    method: 'POST',
                    headers: {
                        'X-Turnstile-Token': token
                    }
                })

                if (!response.ok) {
                    pending = false
                    const data = await response.json()
                    alert(await data.message)
                    pending = false
                    return
                }

                const item = await response.text()
                pending = false

                retry.onclick = pull1
                result.classList.remove('grid-cols-4')
                result.classList.remove('sm:grid-cols-5')
                result.classList.add('grid-cols-1')

                while (result.firstElementChild)
                    result.removeChild(result.firstElementChild)

                result.appendChild(document.createElement('div'))
                result.appendChild(document.createElement('div'))

                if (item) result.appendChild(createTicket(item, 200))
                else result.appendChild(createSalt(200))

                gacha.setAttribute('open', '')

                let history = localStorage.getItem('gacha-history')
                history = history ? JSON.parse(history) : []

                history.push(item)
                localStorage.setItem('gacha-history', JSON.stringify(history))

                totalPull.textContent = formatNumber(history.length)
                totalPullInGacha.textContent = formatNumber(history.length)
            }

            async function pull10() {
                if (debounce(2200) || pending) return

                requestNewToken()

                pending = true
                const response = await fetch(`/pull/10?uid=${uid}`, {
                    method: 'POST',
                    headers: {
                        'X-Turnstile-Token': token
                    }
                })

                if (!response.ok) {
                    pending = false
                    const data = await response.json()
                    alert(await data.message)
                    pending = false
                    return
                }

                const items = await response.json()
                pending = false

                retry.onclick = pull10
                result.classList.add('grid-cols-4')
                result.classList.add('sm:grid-cols-5')
                result.classList.remove('grid-cols-1')

                while (result.firstElementChild)
                    result.removeChild(result.firstElementChild)

                for (let i = 0; i < items.length; i++) {
                    const item = items[i]

                    if (item)
                        result.appendChild(createTicket(item, 200 + i * 200))
                    else result.appendChild(createSalt(200 + i * 200))
                }

                gacha.setAttribute('open', '')

                let history = localStorage.getItem('gacha-history')
                history = history ? JSON.parse(history) : []

                history.push(...items)
                localStorage.setItem('gacha-history', JSON.stringify(history))

                totalPull.textContent = formatNumber(history.length)
                totalPullInGacha.textContent = formatNumber(history.length)
            }

            function loadHistory() {
                const history = localStorage.getItem('gacha-history')

                const historyDialog = document.getElementById('history')
                const tbody = historyDialog.querySelector('tbody')
                while (tbody.firstElementChild)
                    tbody.removeChild(tbody.firstElementChild)

                if (history) {
                    const items = JSON.parse(history)

                    items.slice(-500).forEach((item, index) => {
                        const tr = document.createElement('tr')
                        tr.classList.add('*:px-4', '*:py-2')

                        const tdIndex = document.createElement('td')
                        tdIndex.classList.add('min-w-24')
                        tdIndex.textContent = formatNumber(
                            index + 1 + Math.max(0, items.length - 500)
                        )

                        const tdName = document.createElement('td')
                        tdName.classList.add('w-full')
                        tdName.textContent = item
                            ? `‡∏ï‡∏±‡πã‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô Stupid Hackathon ‡∏£‡∏´‡∏±‡∏™: ${item}`
                            : '‡πÄ‡∏Å‡∏•‡∏∑‡∏≠'

                        tr.appendChild(tdIndex)
                        tr.appendChild(tdName)

                        tbody.prepend(tr)
                    })
                }

                document.getElementById('history').setAttribute('open', '')
            }

            function turnstileCallback(turnstileToken) {
                const verifying = document.getElementById('verifying')
                if (!turnstileToken) {
                    verifying.textContent =
                        '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'
                    verifying.classList.add('text-red-500')
                    verifying.classList.remove('hidden')
                }

                token = turnstileToken

                pulls.forEach((pull) => {
                    pull.disabled = false
                })
            }

            const audioContext =
                window.AudioContext || window.webkitAudioContext
            const audio = new audioContext()

            let nihahaSound = fetch('/nihaha.mp3')
                .then((res) => res.arrayBuffer())
                .then(
                    (buffer) =>
                        new Promise((resolve) =>
                            audio.decodeAudioData(buffer, (buffer) => {
                                resolve(buffer)
                            })
                        )
                )

            async function nihaha() {
                const source = audio.createBufferSource()
                source.buffer = await nihahaSound
                source.connect(audio.destination)

                source.start(0)
            }
        </script>
    </body>
</html>
